---
title: "modelling-with-statcan-workflow"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{modelling-with-statcan-workflow}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  comment = "#>",
  fig.width = 7,
  dpi = 300
)
```

```{r setup, message=FALSE}
library(aggregate.model)
library(dplyr)
library(statcanR)
library(ggplot2)
```
This is a vignette to describe the process of how to run the model, create forecasts, and create hindcasts using data from Statistics Canada via the implemented statcan dictionary within aggregate.model.

## Specification

We use a specification for illustrative purposes only. Our specification
contains the following four modules/equations:

```{r specification}
specification <- dplyr::tibble(
    type = c(
      "d",
      "n"
    ),
    dependent = c(
      "EmiCO2Industry",
      "IndProd"
    ),
    independent = c(
      "HICP_GAS + HICP_Energy + IndProd",
      "GAS"

    )
  )
print(specification)
```

##Load statcan dictionary

```{r dictionary}
dictionary <- aggregate.model::statcan_dict
```

The statcan dictionary contains a different set of variables than found within eurostat. Due to the way statistics Canada's R package pulls data we need to include all the same headers found within the eurostat dictionary in the statcan dictionary to help with data consistency.

```{r dictionary pt.2}
dictionary <- aggregate.model::statcan_dict
print(colnames(dictionary))
print(colnames(aggregate.model::dict))
```

##Preform modelling
Now let's model the equations we have specified and perform some forecasting.

```{r, forecast-plot, fig.width=3, fig.height=3}
model <- run_model(specification = specification, dictionary = dictionary, primary_source = "download",quiet = TRUE)
forecast <- forecast_model(model = model,
                           exog_predictions = NULL,
                           plot.forecast = FALSE)

plot(forecast)

```

